#!/usr/bin/env zunit

@test 'Testing default Emacs shell prompt' {
	load ../agkozak-zsh-theme.plugin.zsh

	set_macro emacs_pwd '$(_agkozak_prompt_dirtrim "$AGKOZAK_PROMPT_DIRTRIM")'
	set_macro sync_git_branch_status '$(_agkozak_branch_status)'
	set_macro prompt_char '%#'

	AGKOZAK_ZPML_PROMPT=(
	  if is_exit_0 then
	  else
	    exit_status space
	  fi

	  user_host space

	  emacs_pwd
	  sync_git_branch_status space
	  prompt_char space
	)

	assert "$(_agkozak_construct_prompt AGKOZAK_ZPML_PROMPT)" same_as '%(?..(%?%) )%n%1v $(_agkozak_prompt_dirtrim "$AGKOZAK_PROMPT_DIRTRIM")$(_agkozak_branch_status) %# '
}
