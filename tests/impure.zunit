#!/usr/bin/env zunit

@test 'impure prompt' {
	load ../agkozak-zsh-theme.plugin.zsh
	AGKOZAK_HAS_COLORS=1

	AGKOZAK_ZPML_PROMPT=(
	  fg_blue literal '%~' unfg
	  fg_242 git_branch_status unfg
	  newline
	  if is_exit_0 then
	    fg_magenta
	  else
	    fg_red
	  fi
	  literal '❯' unfg space
	)

	AGKOZAK_ZPML_RPROMPT=()

	[[ "$(_agkozak_construct_prompt AGKOZAK_ZPML_PROMPT)" == $'%F{blue}%~%f%F{242}%3v%f\n%(?.%F{magenta}.%F{red})❯%f ' ]]

	assert $state equals 0
}
